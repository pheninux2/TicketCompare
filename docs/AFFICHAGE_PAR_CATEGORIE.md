# ğŸ“Š Affichage par CatÃ©gorie - Page Consommation

## âœ¨ Nouvelle FonctionnalitÃ©

La page Consommation affiche maintenant les produits **organisÃ©s par catÃ©gorie** avec un systÃ¨me d'accordÃ©on.

## ğŸ¯ Avantages

âœ… **Organisation claire** : Produits groupÃ©s par catÃ©gorie  
âœ… **Navigation facile** : AccordÃ©ons dÃ©pliables/repliables  
âœ… **Sous-totaux** : CoÃ»t par catÃ©gorie visible immÃ©diatement  
âœ… **Total gÃ©nÃ©ral** : RÃ©capitulatif en bas de page  
âœ… **DÃ©tails prÃ©servÃ©s** : Badge cliquable pour voir les achats multiples

---

## ğŸ“Š Apparence

### Vue Globale

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸ“Š Produits AchetÃ©s par CatÃ©gorie [15 produits]         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                           â•‘
â•‘ â–¼ ğŸ·ï¸ Fruits & LÃ©gumes [3 produits] [â‚¬15.50]            â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â•‘
â•‘   â”‚ Tomates   â”‚ 2.5kg â”‚ kg â”‚ â‚¬9.50  â”‚ 2 â”‚ â‚¬3.80 â”‚       â•‘
â•‘   â”‚ Pommes    â”‚ 1.0kg â”‚ kg â”‚ â‚¬3.00  â”‚ 1 â”‚ â‚¬3.00 â”‚       â•‘
â•‘   â”‚ Salade    â”‚ 1.0pc â”‚ pc â”‚ â‚¬3.00  â”‚ 1 â”‚ â‚¬3.00 â”‚       â•‘
â•‘   â”‚ Sous-total: 3 produits           â”‚ â‚¬15.50  â”‚       â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â•‘
â•‘                                                           â•‘
â•‘ â–¶ ğŸ·ï¸ Laitier [2 produits] [â‚¬9.00]                      â•‘
â•‘                                                           â•‘
â•‘ â–¶ ğŸ·ï¸ Boulangerie [4 produits] [â‚¬12.30]                 â•‘
â•‘                                                           â•‘
â•‘ â–¶ ğŸ·ï¸ Ã‰picerie [5 produits] [â‚¬23.45]                    â•‘
â•‘                                                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ TOTAL GÃ‰NÃ‰RAL : â‚¬60.25                    15 achats     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### CatÃ©gorie Ouverte

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–¼ ğŸ·ï¸ Laitier [3 produits] [â‚¬9.00]                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Produit      â”‚ QtÃ©  â”‚ UnitÃ© â”‚ CoÃ»t  â”‚ Achats â”‚ Prix/U  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Lait         â”‚ 6.00 â”‚ L     â”‚ â‚¬9.00 â”‚   3    â”‚ â‚¬1.50   â”‚
â”‚ [â–¼ 3 achats] â”‚      â”‚       â”‚       â”‚        â”‚         â”‚ â† Clic
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ DÃ©tails des achats :                                    â”‚
â”‚ â€¢ 25/12 LIDL      : 2.00L Ã  â‚¬1.50 = â‚¬3.00              â”‚
â”‚ â€¢ 20/12 Carrefour : 2.00L Ã  â‚¬1.50 = â‚¬3.00              â”‚
â”‚ â€¢ 15/12 LIDL      : 2.00L Ã  â‚¬1.50 = â‚¬3.00              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Sous-total Laitier : 3 produits â”‚ â‚¬9.00 â”‚ 3 achats    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ Fonctionnement

### 1. AccordÃ©on par CatÃ©gorie

Chaque catÃ©gorie est un accordÃ©on cliquable :

**En-tÃªte de catÃ©gorie :**
- ğŸ·ï¸ **IcÃ´ne catÃ©gorie**
- **Nom de la catÃ©gorie** (ex: "Fruits & LÃ©gumes")
- **Badge bleu** : Nombre de produits
- **Badge rouge** : CoÃ»t total de la catÃ©gorie

**Comportement :**
- â–¼ **Ouvert** : Fond vert, affiche les produits
- â–¶ **FermÃ©** : Fond blanc, masque les produits
- **Clic** : Ouvre/Ferme la catÃ©gorie

### 2. Tableau par CatÃ©gorie

Chaque catÃ©gorie contient un tableau avec :

**Colonnes :**
- ğŸ“¦ **Produit** (avec badge d'achats multiples si applicable)
- âš–ï¸ **QuantitÃ© totale**
- ğŸ“ **UnitÃ©**
- ğŸ’° **CoÃ»t total** (en rouge)
- ğŸ›’ **Nombre d'achats** (badge bleu)
- ğŸ§® **Prix moyen par unitÃ©**

**Pied de tableau :**
- **Sous-total** de la catÃ©gorie
- Nombre de produits
- CoÃ»t total
- Nombre d'achats

### 3. DÃ©tails des Achats

Si un produit est achetÃ© plusieurs fois :
- Badge jaune : `[â–¼ X achats]`
- Clic â†’ DÃ©ploie les dÃ©tails
- Tableau des achats individuels

### 4. Total GÃ©nÃ©ral

Footer noir avec :
- ğŸ’° **Total** : Somme de tous les coÃ»ts
- ğŸ›’ **Achats** : Nombre total d'achats

---

## ğŸ”§ Modifications Techniques

### 1. ConsumptionController.java

**Ajout du groupement par catÃ©gorie :**

```java
// Grouper par catÃ©gorie
var consumptionByCategory = consumption.stream()
    .collect(Collectors.groupingBy(
        item -> item.getCategory() != null ? item.getCategory() : "Non catÃ©gorisÃ©",
        LinkedHashMap::new,
        Collectors.toList()
    ));

model.addAttribute("consumptionByCategory", consumptionByCategory);
```

### 2. weekly.html

**Structure avec accordÃ©ons Bootstrap :**

```html
<div class="accordion" id="categoryAccordion">
    <th:block th:each="categoryEntry : ${consumptionByCategory}">
        <div class="accordion-item">
            <!-- En-tÃªte -->
            <h2 class="accordion-header">
                <button class="accordion-button" 
                        data-bs-toggle="collapse">
                    CatÃ©gorie + Badges
                </button>
            </h2>
            
            <!-- Contenu -->
            <div class="accordion-collapse collapse">
                <table>
                    <!-- Produits de la catÃ©gorie -->
                </table>
            </div>
        </div>
    </th:block>
</div>
```

### 3. CSS PersonnalisÃ©

```css
.accordion-button:not(.collapsed) {
    background-color: #198754; /* Vert quand ouvert */
    color: white;
}

.accordion-item {
    border: 2px solid #dee2e6;
    margin-bottom: 0.5rem;
    border-radius: 0.5rem;
}
```

---

## ğŸ“‹ Structure des DonnÃ©es

### ModÃ¨le de DonnÃ©es

```
consumptionByCategory (Map)
â”œâ”€ "Fruits & LÃ©gumes" (clÃ©)
â”‚  â””â”€ List<ConsumptionDTO> (valeur)
â”‚     â”œâ”€ Tomates
â”‚     â”œâ”€ Pommes
â”‚     â””â”€ Salade
â”‚
â”œâ”€ "Laitier"
â”‚  â””â”€ List<ConsumptionDTO>
â”‚     â”œâ”€ Lait (avec 3 achats)
â”‚     â””â”€ Yaourt
â”‚
â”œâ”€ "Boulangerie"
â”‚  â””â”€ List<ConsumptionDTO>
â”‚     â”œâ”€ Pain
â”‚     â””â”€ Croissants
â”‚
â””â”€ "Non catÃ©gorisÃ©"
   â””â”€ List<ConsumptionDTO>
      â””â”€ Produit sans catÃ©gorie
```

---

## ğŸ¯ Exemple d'Utilisation

### Cas 1 : Vue d'Ensemble

**Action :** Charger la page `/consumption/weekly`

**RÃ©sultat :**
```
Fruits & LÃ©gumes [3] [â‚¬15.50] â–¼ (ouvert par dÃ©faut)
Laitier [2] [â‚¬9.00] â–¶
Boulangerie [4] [â‚¬12.30] â–¶
Ã‰picerie [5] [â‚¬23.45] â–¶
```

### Cas 2 : Explorer une CatÃ©gorie

**Action :** Cliquer sur "Laitier"

**RÃ©sultat :**
```
Laitier [2] [â‚¬9.00] â–¼
â”œâ”€ Lait : 6.00L â†’ â‚¬9.00 (3 achats)
â””â”€ Sous-total : â‚¬9.00
```

### Cas 3 : Voir les DÃ©tails d'un Produit

**Action :** Cliquer sur le badge `[â–¼ 3 achats]` du Lait

**RÃ©sultat :**
```
DÃ©tails des achats :
â”œâ”€ 25/12 LIDL      : 2.00L Ã  â‚¬1.50 = â‚¬3.00
â”œâ”€ 20/12 Carrefour : 2.00L Ã  â‚¬1.50 = â‚¬3.00
â””â”€ 15/12 LIDL      : 2.00L Ã  â‚¬1.50 = â‚¬3.00
```

### Cas 4 : Filtrer par Recherche

**Action :** Rechercher "lait"

**RÃ©sultat :**
```
Laitier [1] [â‚¬9.00] â–¼
â””â”€ Lait : 6.00L â†’ â‚¬9.00
```

Seule la catÃ©gorie "Laitier" s'affiche avec le produit "Lait".

---

## âœ¨ Avantages de l'Organisation par CatÃ©gorie

### Pour l'Analyse

âœ… **Vision claire** : Voir immÃ©diatement quelles catÃ©gories coÃ»tent le plus  
âœ… **Comparaison facile** : Comparer les dÃ©penses par type de produit  
âœ… **Budget** : Suivre les dÃ©penses par catÃ©gorie  
âœ… **Tendances** : Identifier les catÃ©gories de consommation

### Pour la Navigation

âœ… **Rapide** : Trouver un produit en ouvrant sa catÃ©gorie  
âœ… **OrganisÃ©** : Plus besoin de scroller dans une longue liste  
âœ… **Focus** : Se concentrer sur une catÃ©gorie Ã  la fois

### Exemples Pratiques

**Analyser les Fruits & LÃ©gumes :**
```
â–¼ Fruits & LÃ©gumes [â‚¬45.30 ce mois]
  â†’ 15% du budget total
  â†’ CatÃ©gorie la plus chÃ¨re
```

**Budget par CatÃ©gorie :**
```
1. Fruits & LÃ©gumes : â‚¬45.30 (15%)
2. Viande           : â‚¬39.50 (13%)
3. Laitier          : â‚¬28.70 (10%)
4. Ã‰picerie         : â‚¬67.20 (22%)
5. Boulangerie      : â‚¬22.15 (7%)
```

---

## ğŸ¨ Design et Couleurs

### En-tÃªtes d'AccordÃ©on

**FermÃ© (â–¶)** :
- Fond : Blanc
- Texte : Noir
- Bordure : Grise

**Ouvert (â–¼)** :
- Fond : **Vert** (#198754)
- Texte : **Blanc**
- Badges : Blanc avec texte vert

### Badges

- **Nombre de produits** : Bleu (#0d6efd)
- **CoÃ»t total** : Rouge (#dc3545)
- **Achats multiples** : Jaune (#ffc107)

### Footer Total

- Fond : Noir (#212529)
- Texte : Blanc
- Total : **Jaune** (#ffc107)

---

## ğŸš€ RÃ©sultat Final

### Interface ComplÃ¨te

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ ğŸ“Š Consommation de Produits - DÃ©cembre 2024             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ [Filtres : PÃ©riode | Recherche | Tri]                   â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ ğŸ“¦ Produits AchetÃ©s par CatÃ©gorie [15]                  â•‘
â•Ÿâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¢
â•‘                                                           â•‘
â•‘ â–¼ ğŸ·ï¸ Fruits & LÃ©gumes [3] [â‚¬15.50]                     â•‘
â•‘   [Tableau des 3 produits + sous-total]                 â•‘
â•‘                                                           â•‘
â•‘ â–¼ ğŸ·ï¸ Laitier [2] [â‚¬9.00]                               â•‘
â•‘   [Tableau des 2 produits + sous-total]                 â•‘
â•‘                                                           â•‘
â•‘ â–¶ ğŸ·ï¸ Boulangerie [4] [â‚¬12.30]                          â•‘
â•‘                                                           â•‘
â•‘ â–¶ ğŸ·ï¸ Ã‰picerie [5] [â‚¬23.45]                             â•‘
â•‘                                                           â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ TOTAL GÃ‰NÃ‰RAL : â‚¬60.25                    15 achats     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## ğŸ‰ RÃ©sumÃ©

âœ… **AccordÃ©ons par catÃ©gorie** : Organisation claire et intuitive  
âœ… **Sous-totaux** : CoÃ»t et nombre de produits par catÃ©gorie  
âœ… **Total gÃ©nÃ©ral** : RÃ©capitulatif en bas  
âœ… **DÃ©tails prÃ©servÃ©s** : Badge cliquable pour achats multiples  
âœ… **Design soignÃ©** : Couleurs, icÃ´nes, animations  
âœ… **Responsive** : Fonctionne sur mobile et desktop

**Date : 26 DÃ©cembre 2024**  
**FonctionnalitÃ© : Affichage par catÃ©gorie**  
**Statut : âœ… ImplÃ©mentÃ©**

